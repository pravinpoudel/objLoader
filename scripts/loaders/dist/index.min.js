"use strict";var _webglutility=require("../utility/webglutility.js");function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}!function(){var r,B,t,a,R,i,n,T,U,y,E,x,u,l,c,m,A,o,p,L,w,h,D,S,Y,C,I,f,b,s,g,v,_,F,d,V,M,P,W;regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(W=function(){_webglutility.webglUtility.resizeCanvas(B.canvas),B.viewport(0,0,B.canvas.width,B.canvas.height),B.clear(B.DEPTH_BUFFER_BIT|B.COLOR_BUFFER_BIT),B.enable(B.DEPTH_TEST),B.clearColor(.1,.1,.1,.3),V+=.008;var e=m4.yRotation(V);B.uniformMatrix4fv(u,!1,e);var r=m4.inverse(e);B.uniformMatrix4fv(m,!0,r);var t=B.canvas.clientWidth/B.canvas.clientHeight,a=Math.PI/180*60,i=m4.perspective(a,t,.1,1e3);B.uniform1f(c,.5),d+=0;var n=m4.yRotation(d),o=[(n=m4.translate(n,0,.1,_*M))[12],n[13],n[14]];viewMatrix=m4.inverse(n),B.uniform3fv(A,o);var f=m4.multiply(i,viewMatrix);B.uniformMatrix4fv(l,!1,f),P.forEach(function(e,r){var t=e.positionBuffer,a=e.colorBuffer,i=e.normalBuffer,n=e.textureBuffer,o=e.tangentBuffer,f=(e.biTangentBuffer,e.material),u=e.length,l=f.ambient,c=void 0===l?[1,1,1]:l,m=f.diffuse,A=void 0===m?[.8,.87,.8]:m,b=(f.opticalDensity,f.specular),s=void 0===b?[0,0,0]:b,R=f.emmisive,g=void 0===R?[0,0,0]:R,v=f.shininess,_=void 0===v?1:v,F=f.opacity,d=void 0===F?1:F;B.bindBuffer(B.ARRAY_BUFFER,t),B.enableVertexAttribArray(T),B.vertexAttribPointer(T,3,B.FLOAT,!1,0,0),B.bindBuffer(B.ARRAY_BUFFER,i),B.enableVertexAttribArray(y),B.vertexAttribPointer(y,3,B.FLOAT,!1,0,0),B.bindBuffer(B.ARRAY_BUFFER,a),B.enableVertexAttribArray(U),B.vertexAttribPointer(U,3,B.FLOAT,!1,0,0),B.bindBuffer(B.ARRAY_BUFFER,n),B.enableVertexAttribArray(E),B.vertexAttribPointer(E,2,B.FLOAT,!1,0,0),B.bindBuffer(B.ARRAY_BUFFER,o),B.enableVertexAttribArray(x),B.vertexAttribPointer(x,3,B.FLOAT,!1,0,0),B.uniform3fv(p,c),B.uniform3fv(L,A),B.uniform3fv(w,s),B.uniform3fv(h,g),B.uniform1f(S,parseFloat(d)),B.uniform1f(D,_),B.activeTexture(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,f.normalMap),B.activeTexture(B.TEXTURE1),B.bindTexture(B.TEXTURE_2D,f.diffuseMap),B.activeTexture(B.TEXTURE2),B.bindTexture(B.TEXTURE_2D,f.specularMap),B.uniform1i(C,0),B.uniform1i(Y,1),B.uniform1i(I,2),B.drawArrays(B.TRIANGLES,0,u/3)}),window.requestAnimationFrame(W)},r=document.getElementById("main-canvas"),B=r.getContext("webgl2")){e.next=6;break}return console.log("context couldnot be generated"),e.abrupt("return");case 6:return e.next=8,regeneratorRuntime.awrap(objFileLoader(B));case 8:t=e.sent,a=t.geometries,R=t.materials,i=t.minMax,console.log(a),n=_webglutility.webglUtility.createProgramFromShaderVariable(B,loader_VS,loader_FS),B.useProgram(n),T=B.getAttribLocation(n,"a_position"),U=B.getAttribLocation(n,"a_color"),y=B.getAttribLocation(n,"a_normal"),E=B.getAttribLocation(n,"a_texCord"),x=B.getAttribLocation(n,"a_tangent"),B.getAttribLocation(n,"a_bitangent"),u=B.getUniformLocation(n,"u_modelMatrix"),l=B.getUniformLocation(n,"u_vpMatrix"),c=B.getUniformLocation(n,"u_scale"),m=B.getUniformLocation(n,"u_worldNormal"),A=B.getUniformLocation(n,"u_cameraWorld"),o=B.getUniformLocation(n,"u_lightDirection"),p=B.getUniformLocation(n,"ambient"),L=B.getUniformLocation(n,"diffuse"),w=B.getUniformLocation(n,"specular"),h=B.getUniformLocation(n,"emmisive"),D=B.getUniformLocation(n,"shininess"),S=B.getUniformLocation(n,"opacity"),Y=B.getUniformLocation(n,"diffuseSampler"),C=B.getUniformLocation(n,"normalSampler"),I=B.getUniformLocation(n,"specularSampler"),f=B.getUniformLocation(n,"hasNormal"),b=B.getUniformLocation(n,"u_ambientLight"),s=i.min,g=i.max,v=m4.subtractVectors(g,s),_=m4.length(v),m4.scaleVector(m4.addVectors(s,m4.scaleVector(v,.5)),-1),F=B.createVertexArray(),B.bindVertexArray(F),d=0,V=.5,M=.6,P=a.map(function(e,r){var t=B.createBuffer();B.bindBuffer(B.ARRAY_BUFFER,t);var a=e.attributes.position;B.bufferData(B.ARRAY_BUFFER,new Float32Array(_toConsumableArray(a)),B.STATIC_DRAW);var i=B.createBuffer();B.bindBuffer(B.ARRAY_BUFFER,i);var n=e.attributes.colorValue;B.bufferData(B.ARRAY_BUFFER,new Float32Array(n),B.STATIC_DRAW);var o=e.attributes.normalCord,f=B.createBuffer();B.bindBuffer(B.ARRAY_BUFFER,f),B.bufferData(B.ARRAY_BUFFER,new Float32Array(o),B.STATIC_DRAW);var u=e.attributes.textCord,l=B.createBuffer();B.bindBuffer(B.ARRAY_BUFFER,l),B.bufferData(B.ARRAY_BUFFER,new Float32Array(u),B.STATIC_DRAW);var c=e.tangents,m=B.createBuffer();B.bindBuffer(B.ARRAY_BUFFER,m),B.bufferData(B.ARRAY_BUFFER,new Float32Array(c),B.STATIC_DRAW);var A=e.biTangent,b=B.createBuffer();B.bindBuffer(B.ARRAY_BUFFER,b),B.bufferData(B.ARRAY_BUFFER,new Float32Array(A),B.STATIC_DRAW);var s=e.material;return{positionBuffer:t,colorBuffer:i,normalBuffer:f,textureBuffer:l,tangentBuffer:m,biTangentBuffer:b,length:a.length,material:R[s]}}),B.uniform3fv(o,[10,10,50]),B.uniform3fv(b,[.2,.2,.2]),B.uniform1i(f,0),window.requestAnimationFrame(W);case 52:case"end":return e.stop()}})}();
//# sourceMappingURL=index.min.js.map
